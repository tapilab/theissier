<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        html { height: 100% }
        body { height: 100%; margin: 0; padding: 0 }
        #map-canvas { height: 100% }
    </style>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="http://localhost:10001/socket.io/socket.io.js"></script>
    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAXmKFXOfbzFxjrP5BO-Jw8ZTtooWm0XKU&sensor=true">
    </script>
    <script type="text/javascript">
        var socket = io.connect('http://localhost:10001');
        function initialize() {
            var mapOptions = {
                zoom: 3,
                center: new google.maps.LatLng(10, 0)
            }

            var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

            socket.on('twitterStream', function (data) {
                var usernameAndTweet = "<div id='contentInfoWindow'><h3>" + data.user.name + "</h3><h5>"+ data.created_at +"</h5><p>"+ data.text +"</p></div>";
                var myLatlng = new google.maps.LatLng(data.geo.coordinates[0],data.geo.coordinates[1]);
                var infowindow = new google.maps.InfoWindow({
                    content: usernameAndTweet
                });
                var marker = new google.maps.Marker({
                    position: myLatlng,
                    map: map,
                    title: usernameAndTweet
                });
                google.maps.event.addListener(marker, 'click', function() {
                    infowindow.open(map,marker);
                });
            });
        }
        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
</head>
<body>
<div id="map-canvas"/>
</body>
</html>